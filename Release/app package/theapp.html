<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<style>
    .jumbotron
    {
        background-color: rgb(189, 205, 216);
        margin: auto;
        padding: 15px;
        width: auto;
        height: auto;
        top:5px;
        left:5px;
        right:5px;
        border: 1px solid black;
        font-family: '微软雅黑'
    }
    .col-md-4 {
        background-color: rgb(236, 146, 151);
        margin:10px 15px 0px;
        padding: 10px;
        width: auto;
        height: auto;
        border: 1px solid black;
        cursor: pointer;
        font-family: '微软雅黑'
    }
    p {
        line-height: 16px;
    }
</style>

<body topmargin='0' leftmargin='0'>

    <div class="container">
        <div class="jumbotron">
            <h1 align='center'>环翠国土信息服务平台</h1>
            <p align='right'>威海市国土资源局 · 环翠分局</p>
            <p align='right'>技术支持：5273031</p>
        </div>
        <div class="row">
            <div class="col-md-4" style="cursor:auto;">
                <h2>当前用户</h2>
                <p id='user_name'>用户名：未登录</p>
                <p id='user_office'>科室：未知</p>
                <p>您可以<a style="cursor: pointer;color: blue;" onclick="on_login()">登录系统</a>，在用户名所授予的权限内使用相应的平台功能。
                    您还能够<a style="cursor: pointer;color: blue;" onclick="on_modify_password()">修改密码</a>，保护您的数据和权益安全。 </p>
            </div>
            <div class="col-md-4" style="background-color:rgb(35, 223, 176)" onclick="on_todo()">
                <h2>待办事项</h2>
                <p id='id_n_task'>您有0件需要完成的工作。</p>
                <p >您可以在此创建待办事项，或者将事项派送给他人处理，“信息中心服务”中的部分事项也可以在此查看进度。</p>
            </div>
            <div class="col-md-4" style="cursor:auto;background-color:rgb(210, 236, 58);" >
                <h2>信息中心服务</h2>
                <p>当您申请下列服务后，信息中心会及时进行处理，您能够在“待办事项”中查看处理的进度和结果。</p>
                <p>您可以通过<a style="cursor: pointer;color: blue;" onclick="on_make_picture()">作图服务</a>来申请测绘公司进行图件的制作。
                    通过<a style="cursor: pointer;color: blue;" onclick="on_print_picture()">打印服务</a>来申请打印已有图件。
                </p>
                <p>您可以通过<a style="cursor: pointer;color: blue;" onclick="on_manual_query()">人工查询</a>申请工作人员为您查询信息，
                    通过<a style="cursor: pointer;color: blue;" onclick="on_query()">数据库查询服务</a>来访问信息中心数据库。
                </p>
                <p>您可以通过<a style="cursor: pointer;color: blue;" onclick="on_publish_information()">信息发布服务</a>申请在市局信息平台、分局网站、楼下大屏幕发布信息，
                    通过<a style="cursor: pointer;color: blue;" onclick="on_it_support()">IT技术支持</a>申请解决网络、计算机、软件、打印机等问题，如果因为网络故障无法使用此功能，请致电信息中心。
                </p>
            </div>
            <div class="col-md-4" style="cursor:auto;background-color:rgb(41, 219, 50);" >
                <h2>小程序</h2>
                <p>小程序能够提供一些便捷的办公功能，用来提高办公效率，如果您有什么需求请联系信息中心开发相应功能。</p>
                <p>办公室<a style="cursor: pointer;color: blue;" onclick="on_print_label()">打印桌签</a>功能能够打印2至6字桌签。
                </p>
            </div>
            <div class="col-md-4" style="background-color:rgb(206, 218, 207) " onclick="on_update_detail()">
                <h2>更新日志</h2>
                <p>信息平台系统更新情况。欢迎多提宝贵意见或建议！</p>
            </div>
        </div>
    </div>

    <script type="text/javascript">

        //PyFun('exe.set_maxmize')
        PyFun('exe.set_size', 0, -1, 0, 0, 1)
        PyFun('exe.set_title', '环翠国土信息平台')
        PyFun('login.do_login',0)
        _info= PyFun('login.get_user_info')
        user_name.innerHTML='用户名：'+_info[0] 
        user_office.innerHTML='科室：'+_info[1] 
        n= PyFun('todo.get_n_todo')
        id_n_task.innerHTML='您有'+n+'件需要完成的工作。'
        function on_login() { PyFun('login.do_login',1); }
        function on_todo(){ if(_info[0]==''){PyFun('msgbox','请先登录！','信息平台'); }else {PyFun('todo.on_todo');};}
        function on_update_detail(){PyFun('theapp._load_htmls','update_detail.html');}//PyFun('inputer.do_input','输入标题',[],'input_complete');}//
        function set_log_info(s){user_info.innerHTML=s;}
        function on_query()//数据库查询
        {
            if(_info[1]=='信息中心 ')
            {
                PyFun('kingland.show_page');
            }
            else
            {
                PyFun('msgbox','该功能暂末正式开放，敬请期待！','信息平台');
            }
        }

//on_create_event(title,describe,deadline,priority,fn,to_)
        function on_manual_query()
        {
            if(_info[0]==''){PyFun('msgbox','请先登录。','国土信息平台');return;}
            if(arguments.length==0)
            {
                itms=[['查询内容描述：','txt_s',[],''],
                ['附件（多文件请打包）：','file',[],'']]
                PyFun('inputer.do_input','申请人工查询',itms,'on_manual_query');
            }
            else
            {
                p=arguments[0];
                if(p.length==0)return;
                if(!p[0])
                {
                    PyFun('msgbox','内容描述不能为空。','人工查询申请失败')
                    return;
                }
                dl=PyFun('todo.num2date',1)
                PyFun('todo.on_create_event','人工查询',p[0],dl,'普通',p[1],'信息中心 ');
            }
        }

        function on_print_picture()
        {
            if(_info[0]==''){PyFun('msgbox','请先登录。','国土信息平台');return;}
            if(arguments.length==0)
            {
                itms=[['图件打印需求：','txt_m',[],''],
                ['附件（多文件请打包）：','file',[],'']]
                PyFun('inputer.do_input','申请打印图件',itms,'on_print_picture');
            }
            else
            {
                p=arguments[0];
                if(p.length==0)return;
                if(!p[0])
                {
                    PyFun('msgbox','图件打印需求不能为空。','打印图件申请失败')
                    return;
                }
                dl=PyFun('todo.num2date',3)
                PyFun('todo.on_create_event','打印图件',p[0],dl,'普通',p[1],'信息中心 ');
            }
        }


        function on_make_picture()
        {
            if(_info[0]==''){PyFun('msgbox','请先登录。','国土信息平台');return;}
            if(arguments.length==0)
            {
                itms=
                [
                ['图件类型：','select',['供地图','征地图','收地图','宗地图','土地预审','示意图（非正式）','勘界图（非正式）','转坐标','其它'],'供地图'],
                ['项目名称：','txt_s',[],''],
                ['面积（多个面积请用逗号或空格隔开）：','txt_s',[],''],
                ['作图依据（规划红线等，多文件请打包）：','file',[],''],
                ['备注：','txt_m',[],'']
                ]
                chk=
                [
                ['len(p[1].strip())==0','项目名称不能为空。'],
                ['len(p[2].strip())==0','面积不能为空。'],
                ['len(p[3])==0 and len(p[4].strip())==0','请提供作图依据，如不能提供，请在备注写明原因。'],
                ]
                PyFun('inputer.do_input','申请测绘出图',itms,'on_make_picture',chk);
            }
            else
            {
                p=arguments[0];
                if(p.length==0)return;
                s=p[0]+','+p[1]+','+p[2]+','+p[4]
                dl=PyFun('todo.num2date',3)
                PyFun('todo.on_create_event','测绘出图',s,dl,'普通',p[3],'信息中心 ');
            }
        }

        function on_publish_information()
        {
            if(_info[0]==''){PyFun('msgbox','请先登录。','国土信息平台');return;}
            if(arguments.length==0)//called by click.
            {
                itms=[['发布内容描述：','txt_s',[],''],
                ['附件（多文件请打包）：','file',[],'']]
                PyFun('inputer.do_input','信息发布申请',itms,'on_publish_information');
            }
            else//called as callback.
            {
                p=arguments[0];
                if(p.length==0)return;
                if(!p[0] || !p[1] )
                {
                    PyFun('msgbox','内容描述和附件不能为空。','网站发布申请失败')
                    return;
                }
                dl=PyFun('todo.num2date',1)
                PyFun('todo.on_create_event','网站信息发布',p[0],dl,'普通',p[1],'信息中心 ');
            }
        }
        function on_it_support()
        {
            if(_info[0]==''){PyFun('msgbox','请先登录。','国土信息平台');return;}
            if(arguments.length==0)//called by click.
            {
                itms=[['问题描述：','txt_m',[],''],
                ['附件（多文件请打包）：','file',[],'']]
                PyFun('inputer.do_input','IT技术支持',itms,'on_it_support');
            }
            else//called as callback.
            {
                p=arguments[0];
                if(p.length==0)return;
                if(!p[0])
                {
                    PyFun('msgbox','内容描述不能为空。','IT技术支持申请失败')
                    return;
                }
                dl=PyFun('todo.num2date',1)
                PyFun('todo.on_create_event','IT技术支持',p[0],dl,'普通',p[1],'信息中心 ');
            }
        }

        function on_print_label()
        {
            if(arguments.length==0)//called by click.
            {
                itms=[['桌签文字（2-6个字）：','txt_s',[],'']]
                chk=[['len(p[0])<2 or len(p[0])>6','桌签文字只能是2-6个字。']]
                PyFun('inputer.do_input','打印桌签',itms,'on_print_label',chk);
            }
            else//called as callback.
            {
                p=arguments[0];
                if(p.length==0)return;
                PyFun('little_program.print_label',p[0]);
            }
        }
        function on_modify_password()
        {
            if(_info[0]==''){PyFun('msgbox','请先登录。','国土信息平台');return;}
            if(arguments.length==0)
            {
                itms=[['原始密码：','txt_p',[],''],
                ['新密码：','txt_p',[],''],
                ['重复新密码：','txt_p',[],'']]
                chk=
                [
                    ['p[1]!=p[2]','两次输入新密码不一致。'],
                    ['p[0]==p[1]','新密码与旧密码相同。']
                ]
                PyFun('inputer.do_input','修改密码',itms,'on_modify_password',chk);
            }
            else
            {
                p=arguments[0];
                if(p.length==0)return;
                PyFun('login.modify_password',p);
            }
       }

        PyFun("theapp.hide_if_autorun")
        PyFun("theapp.flush_alarm")
    </script>
</body>

</html>