<!DOCTYPE html>
<html  style="height:100%;">
<head>
<meta charset="utf-8"> 

<style>
.customers
{
    margin-top: 5px;
    font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
    width:100%;
    border-collapse:collapse;
}
.customers td, .customers th 
{
    align-items: center;
    font-size:1em;
    border:1px solid #98bf21;
    padding:3px 7px 2px 7px;
}
.customers th 
{
    font-size:1.1em;
    text-align:left;
    padding-top:5px;
    padding-bottom:4px;
    background-color:#A7C942;
    color:#ffffff;
}

.detail_table
{
    font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
    width:100%;
    border-collapse:collapse;
}
.detail_table td,.detail_table th 
{
    align-items: center;
    font-size:1em;
    border:2px solid #10df3d;
    padding:3px 7px 2px 7px;
}
.detail_table th 
{
    font-size:1.1em;
    text-align:left;

    background-color:rgb(171, 204, 177);
    color:#ffffff;
}


.nav_btn
{
    margin-top: 5px;
    font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
    width:100%;
    border-collapse:collapse;
}
.nav_btn td
{
    
    border:2px solid #9eb6ca;
    font-size:1.1em;
    text-align:center;
    padding-top:5px;
    padding-bottom:4px;
    color:#ffffff;
}
#FilterInput
{
    border: 1px solid #D2D9dC;
    color: #444;
    font: 16px 'Microsoft YaHei', '微软雅黑';
    padding: 0px ;
    margin-bottom: 0px;
    width: 50%;

}

.scrollTable {
        border: 1px solid #EB8;/*table没有外围的border，只有内部的td或th有border*/
    }
    .scrollTable table {
        border-collapse:collapse; /*统一设置两个table为细线表格*/
    }
    /*表头 div的第一个子元素**/
    .scrollTable table.thead{
        width:100%;
    }
    /*表头*/
    .scrollTable table.thead th{
        border: 1px solid #EB8;
        border-right:#C96;
        color:#fff;
        background: #FF8C00;/*亮桔黄色*/
    }

    /*能带滚动条的表身*/
    /*div的第二个子元素*/
    .scrollTable div{
        width:100%;
        height:200px;
        overflow:auto;/*必需*/

    }

    /*能带滚动条的表身的正体*/
    .scrollTable table.tbody{
        width:100%;
        border: 1px solid #C96;
        border-right:#B74;
        color:#666666;
        background: #ECE9D8;
    }

    /*能带滚动条的表身的格子*/
    .scrollTable table.tbody td{
        border:1px solid #C96;
    }
</style>
</head>
<body  style="height:96%;" background="data:image/gif;base64,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">
            <table height="10%" width="100%">
                <tr>
                    <td width="30%">
                            <table id="navi" class="nav_btn">
                                    <tr>
                                            <td  onmousedown="on_click_nav(this)">待办</td>
                                            <td onmousedown="on_click_nav(this)">已处理</td>
                                            <td onmousedown="on_click_nav(this)">办结</td>
                                            <td onmousedown="on_click_nav(this)">全部</td>
                                    </tr>   
                            </table>
                    </td>
                    <td ><p style="color: #f51010;font-weight: bold;">按关键字显示：<input id="FilterInput" onfocus="this.select()" onkeydown="setTimeout(on_refresh_table,0)"></input></p></td>
                    <td width="30%">
                            <table cellspacing="5" class="nav_btn">
                                    <tr>
                                        <td bgColor="green" onmousedown="on_create()">创建</td>
                                        <td bgColor="green" onmousedown="on_modify()">修改</td>
                                        <td bgColor="green" onmousedown="on_delete()">删除</td>
                                        <td bgColor="green" onmousedown="on_handle()">办理</td>
                                        <td bgColor="green" onmousedown="on_recall()">撤销</td>
                                        <td bgColor="red" onmousedown="on_click_nav(this)">返回主页</td>
                                    </tr>   
                            </table>
                    </td>
                </tr>
            </table>

    <div style="height:20%; overflow:auto;">
            <table height="70%" id="details" class="detail_table">
                    <tr height="20%">
                            <th width="50px">编号</th>
                            <td width="60px"></td>
                            <th width="50px">事件</th>
                            <td width="300px"></td>
                            <th width="50px">描述</th>
                            <td></td>
                                  
                    </tr>
                    <tr height="80%">
                            <th>状态</th>
                            <td colspan="5"></td>
                    </tr>
            
            </table>
    </div>


    <div id='table_container' style="height: 70%;">
        </div>
    






<script type="text/javascript">
var last_itm=-1;
var current_nav='';
received_data=[];
current_user=PyFun('login.get_user_info')[0]

//PyFun('exe.set_maxmize')

function fillTable(datas)
{
    last_itm=-1;
    if(datas.length==0)
    {
        head_li=["事件类型","当前状态","完成期限","重要程度","事件描述"]
        width_li=[100,100,100,100]
        s_html=PyFun('html_control.create_table','main_table',head_li,width_li,[],"on_click_row")
        table_container.innerHTML=s_html
        show_detail()
        return;
    }

    dat2=[]
    for(x in datas)
    {
        dat=datas[x]
        d0=dat[0][1]
        d1='<font color="green">已处理</font>'
        if(dat[3]=='待办')d1='<font color="red">待办</font>'
        if(dat[3]=='办结')d1='<font color="black">办结</font>'
        d2=dat[0][3]
        d3=dat[0][4]
        d4=datas[x][0][2]
        dat2.push([d0,d1,d2,d3,d4])
    }

    head_li=["事件类型","当前状态","完成期限","重要程度","事件描述"]
    width_li=[100,100,100,100]
    s_html=PyFun('html_control.create_table','main_table',head_li,width_li,dat2,"on_click_row")
    table_container.innerHTML=s_html
    on_click_row(main_table.rows[0])

    //(_id,head_li,width_li,data_li,fun_clk_row)
        // importance=data[0][4]
        // if(data[0][4]=='重要')importance='<font color="red">'+data[0][4]+'</font>'
        // if(data[0][4]=='不重要')importance='<font color="green">'+data[0][4]+'</font>'

        // current_status='<font color="green">'+data[3]+'</font>'
        // if(data[3]=='待办')current_status='<font color="red">'+data[3]+'</font>'
        // if(data[3]=='办结')current_status='<font color="black">'+data[3]+'</font>'

        // row.insertCell(0).innerHTML=data[0][1];
        // row.insertCell(1).innerHTML=current_status;
        // row.insertCell(2).innerHTML=data[0][3];
        // row.insertCell(3).innerHTML=importance;
        // row.insertCell(4).innerHTML=data[0][2];
        // row.onmousedown=on_click_row;
    
}

function on_click_row(the_row)
{
    if(last_itm!=-1)main_table.rows[last_itm].bgColor='';
    last_itm=the_row.rowIndex;
    the_row.bgColor='#8b9ce7'
    show_detail()
}

function on_refresh_table()
{
    received_data=PyFun('todo.get_events',current_nav,FilterInput.value);
    fillTable(received_data);
    PyFun('theapp.flush_alarm');    
}

function on_click_nav(itm)
{
    cels=navi.rows[0].cells;
    for(x=0;x<cels.length;++x)cels[x].bgColor='rgb(9, 180, 157)';
    itm.bgColor="rgb(10, 243, 212)"; 
    //cels[cels.length-1].bgColor='green'
    if(itm.innerHTML=="返回主页")
    {
        PyFun('theapp.go_home_page');
    }
    current_nav=itm.innerHTML;
    on_refresh_table();
    //alert(itm.innerHTML);
}

function show_detail()
{
    if(last_itm==-1)
    { 
        dtl=[['','',''],'','',''];
    }
    else
    {
        dtl=received_data[last_itm]
    }
    r1=details.rows[0];
    r1.cells[1].innerHTML=dtl[0][0];
    r1.cells[3].innerHTML=dtl[0][1];
    r1.cells[5].innerHTML=dtl[0][2];
    details.rows[1].cells[1].innerHTML=dtl[2];
}

function on_create()
{
    if(arguments.length==0)
    {
        dts=PyFun('todo.get_dates');
        users=PyFun('todo.get_users_data',current_user);
        itms=
        [
            ['事件类型：','txt_s',[],''],
            ['事件描述：','txt_m',[],''],
            ['结束时限：','select',dts,dts[3]],
            ['重要程度：','select',['重要','普通','不重要'],'普通'],
            ['附件：','file',[],''],
            ['移交至：','select',users,current_user ]
        ]
        PyFun('inputer.do_input','创建事件',itms,'on_create');
    }
    else
    {
        p=arguments[0];
        if(p.length==0)return;
        PyFun('todo.on_create_event',p[0],p[1],p[2],p[3],p[4],p[5]);
        on_click_nav(navi.rows[0].cells[0]);
    }
}

function on_modify()
{
    if(arguments.length!=0)//called by inputer.
    {
        p=arguments[0]
        if(p.length==0)return;
        evt=received_data[last_itm];
        PyFun('todo.on_modify_event',evt[0][0],p[0],p[1],p[2],p[3]);
        on_refresh_table();
    }
    else//called by click.
    {
        if(last_itm!=-1)
        {
            evt=received_data[last_itm];
            sta=evt[1]
            for(x=0;x<sta.length;++x)
            {
                if (sta[x][0]!=current_user)
                {
                    PyFun('msgbox','无法修改已涉及他人的事件！');
                    return;
                }
            }
            if (evt[1][0][0]!=current_user)
            {
                PyFun('msgbox','无法修改他人创建的事件！');
                return;
            }
            dts=PyFun('todo.get_dates');
            dts=[evt[0][3]].concat(dts)
            itms=[['事件类型：','txt_s',[],evt[0][1]],
            ['事件描述：','txt_m',[],evt[0][2]],
            ['结束时限：','select',dts,evt[0][3]],
            ['重要程度：','select',['重要','普通','不重要'],evt[0][4]]]
            PyFun('inputer.do_input','修改事件',itms,'on_modify');
        }
    }
}

function on_delete()
{
    if(last_itm!=-1)
    {
        evt=received_data[last_itm];
        sta=evt[1]
        for(x=0;x<sta.length;++x)
        {
            if (sta[x][0]!=current_user)
            {
                PyFun('msgbox','无法删除已涉及他人的事件！');
                return;
            }
        }
        if (evt[1][0][0]!=current_user)
        {
            PyFun('msgbox','无法删除他人创建的事件！');
            return;
        }
        if (PyFun('todo.confirm','您确认删除该事件吗？'))
        {
            PyFun('todo.on_delete_event',evt[0][0]);
            on_refresh_table();
        }
    }
}

function on_handle()
{
    if(arguments.length==0)
    {
        if(last_itm!=-1)
        {
            evt=received_data[last_itm];
            users=PyFun('todo.get_users_data',current_user);
            if (evt[3]=='已处理')
            {
                PyFun('msgbox','该事件您已办理！');
                return;
            }
            if (evt[3]=='办结')
            {
                itms=
                [
                    ['备注：','txt_s',[],''],
                    ['附件：','file',[],'']
                ]
            }
            else
            {
                itms=
                [
                    ['备注：','txt_s',[],''],
                    ['移交至：','select',users,evt[1][evt[1].length-1][1] ],
                    ['附件：','file',[],'']
                ]
            }
            PyFun('inputer.do_input','处理事件',itms,'on_handle');
        }
    }
    else
    {
        p=arguments[0]
        if(p.length==0)return;
        if(p.length==2)
        {
            _to='办结';
            cmnt=p[0];
            fn=p[1]
        }
        else
        {
            cmnt=p[0];
            _to=p[1];
            fn=p[2]
        }
        _id=received_data[last_itm][0][0]
        PyFun('todo.on_handle_event',_id,cmnt,_to,fn);
        on_click_nav(navi.rows[0].cells[0]);
    }
}

function on_recall()
{
    if(arguments.length==0)
    {
        if(last_itm!=-1)
        {
            evt=received_data[last_itm];
            if (evt[1].length==1)
            {
                PyFun('msgbox','该事件只有一条状态，如果不需要，请使用删除功能删除整个事件！');
                return;
            }
            if (evt[1][evt[1].length-1][0]!=current_user)
            {
                PyFun('msgbox','您的处理结果不是最后一条，请尝试联系最后一条状态的处理者先行撤销！');
                return;
            }
            if (PyFun('todo.confirm','您确认撤销最后一条状态吗？'))
            {
                PyFun('todo.on_recall_status',evt[0][0]);
                on_refresh_table();
            }
        }
    }
}

function mousein(elm)
{
    elm.style.fontWeight='bold'
}

function mouseout(elm)
{
    elm.style.fontWeight=''
}
//select the first navi_bar as default.
on_click_nav(navi.rows[0].cells[0]);
</script>

</body>
</html>